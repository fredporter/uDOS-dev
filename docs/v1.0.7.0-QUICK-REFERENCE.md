# v1.0.7.0 Quick Reference

**Grid Runtime Teletext System â€“ Quick Lookup**

---

## Cell Addressing

```
Format: AA10 (2 letters + 2 digits)

Columns: AA (0) â†’ DC (79)
Rows: 10 â†’ 39 (internally 0â€“29, offset by 10)

Examples:
  AA10 = top-left (col 0, row 0)
  DC39 = bottom-right (col 79, row 29)
  AB15 = column 1, row 5
```

## Canonical Addresses

```
Format: L{Layer}-{Cell}

Examples:
  L300-AA10  = Surface layer, top-left
  L299-AB15  = Cave layer, center
  L293-DC39  = Substrate, bottom-right

Fractal (zoom): L300-AA10-AA10-AA10
```

## Layer Bands

```
SUR (Surface)    L300 â†’ L305    (precision increases)
UDN (Underground) L299 â†’ L294    (reversed precision)
SUB (Substrate)  L293+           (infinite depth)
```

## Viewport Sizes

```
Standard: 80 columns Ã— 30 rows
Mini: 40 Ã— 15
Right margin: 2 chars
Content width: 78 chars
```

## Graphics Fallback

```
Sextant (16 â–¶) â†’ Quadrant (16 â–¢) â†’ Shade (â–‘â–’â–“â–ˆ) â†’ ASCII (.:@#)
```

## Tile Types

```
Object   = static (buildings, terrain, items)
Sprite   = dynamic, animated (NPCs, creatures)
Marker   = waypoint (spawn, navigation)
```

## Code Blocks

### Teletext

```markdown
\`\`\`teletext
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆ Raw sextant â–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
\`\`\`
```

### Grid

```markdown
\`\`\`grid
baseLayer: 300
location: "L300-AA10"
terrain: grass
\`\`\`
```

### Tiles

```markdown
\`\`\`tiles

- id: tree-1
  address: L300-AA10
  char: "ğŸŒ²"
  type: object
  \`\`\`
```

## Variable Interpolation

```
$player.pos.tile       â†’ "AA10"
$world.layer           â†’ 300
$location.name         â†’ "Forest"
$animation.frame       â†’ 0
$sky.sunRise           â†’ "06:15"

Nested: $a.b.c, $a[0], $a[0].b
```

## Tile Characters

| Mode     | Range | Chars                  |
| -------- | ----- | ---------------------- |
| Sextant  | 0-15  | ğŸ¬€ğŸ¬ğŸ¬‚ğŸ¬ƒğŸ¬„ğŸ¬…ğŸ¬†ğŸ¬‡ğŸ¬ˆğŸ¬‰ğŸ¬ŠğŸ¬‹ğŸ¬ŒğŸ¬ğŸ¬ğŸ¬       |
| Quadrant | 0-15  | â–˜â–â––â–—â–™â–šâ–Œâ–â–€â–â–„â–ˆ (repeats) |
| Shade    | 0-3   | â–‘â–’â–“â–ˆ                   |
| ASCII    | 0-3   | .:@#                   |

## Development

```bash
cd core/grid-runtime
npm install     # Setup
npm run build   # Compile TypeScript
npm test        # Run tests
npm run dev     # Watch mode
```

## Testing

```bash
# All tests
npm test

# Watch
npm test -- --watch

# Coverage
npm test -- --coverage

# Specific file
npm test address.test.ts
```

## File Structure

```
core/grid-runtime/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ geometry.ts      # Constants (37 exports)
â”‚   â”œâ”€â”€ address.ts       # Cell parsing + validation
â”‚   â”œâ”€â”€ viewport.ts      # Viewport manager
â”‚   â”œâ”€â”€ renderer.ts      # Sextant rendering (TODO)
â”‚   â”œâ”€â”€ parser.ts        # Code block parsing (TODO)
â”‚   â”œâ”€â”€ location.ts      # World + pathfinding (TODO)
â”‚   â”œâ”€â”€ sprite.ts        # Animation (TODO)
â”‚   â””â”€â”€ index.ts         # Public API
â”œâ”€â”€ __tests__/
â”‚   â”œâ”€â”€ geometry.test.ts
â”‚   â””â”€â”€ ...
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

## Example: Render Viewport

```typescript
import { ViewportManager, GraphicsMode } from "@udos/grid-runtime";

const viewport = new ViewportManager({ col: 40, row: 15 });
viewport.setViewLayers(300, 299); // SUR + UDN
viewport.setRenderMode(GraphicsMode.Sextant);

const rendered = viewport.compose(); // 2D character array
console.log(viewport.toString()); // String output
```

## Example: Parse Address

```typescript
import {
  parseCanonicalAddress,
  formatCanonicalAddress,
} from "@udos/grid-runtime";

const addr = parseCanonicalAddress("L300-AB15");
// { baseLayer: 300, depth: 0, cell: { col: 1, row: 5 }, band: "SUR" }

const str = formatCanonicalAddress(addr);
// "L300-AB15"
```

## Example: Navigate World

```typescript
import { parseLocationJSON, PathFinder } from "@udos/grid-runtime";

const world = parseLocationJSON(locationData);
const pathfinder = new PathFinder(world);

const path = pathfinder.findPath("L300-AA10", "L300-DC39");
// ["L300-AA10", "L300-AB10", ..., "L300-DC39"]
```

## Performance Targets

- Render 80Ã—30: <100ms
- Parse 100 blocks: <500ms
- Pathfind 100 cells: <10ms
- Animate 10 sprites: <50ms

## Git Commits

```bash
# Phase 1
git commit -m "v1.0.7.0: Phase 1 - Geometry + Address (COMPLETE)"

# Phase 2
git commit -m "v1.0.7.0: Phase 2 - Viewport + Renderer"

# Phase 3
git commit -m "v1.0.7.0: Phase 3 - Code Block Parser"

# Phase 4
git commit -m "v1.0.7.0: Phase 4 - Location + Sparse World"

# Phase 5
git commit -m "v1.0.7.0: Phase 5 - Sprite + Integration"

# Release
git tag v1.0.7.0
git push origin main v1.0.7.0
```

## Links

| Document                                                                     | Purpose              |
| ---------------------------------------------------------------------------- | -------------------- |
| [v1.0.7.0-IMPLEMENTATION-PLAN.md](v1.0.7.0-IMPLEMENTATION-PLAN.md)           | Full phase breakdown |
| [grid-runtime README](../core/grid-runtime/README.md)                        | Architecture + API   |
| [grid-runtime-examples.md](grid-runtime-examples.md)                         | Example scripts      |
| [u_dos_spatial_text_graphics_brief.md](u_dos_spatial_text_graphics_brief.md) | Locked specification |

---

**Status:** Phase 1 âœ… Complete  
**Next:** Phase 2 (Viewport + Renderer)  
**Timeline:** 3-4 weeks â†’ v1.0.7.0 release
