# v1.0.5.0: Mac App Notifications & UI Enhancement

**Status:** ğŸ¯ Planning  
**Release Date:** Target Q1 2026 (Feb-Mar)  
**Theme:** User notifications, real-time feedback, productivity integration  
**Scope:** Mac app only (Tauri/Svelte) + optional Slack integration

---

## ğŸ¯ Mission Statement

Enhance the uMarkdown Mac app with native toast notifications for system events, real-time feedback for long-running operations, and optional Slack integration for team collaboration and notifications.

**Success Criteria:**

- âœ… Toast notifications appear in top-right corner
- âœ… Multiple notification types (info, success, warning, error)
- âœ… Notifications auto-dismiss after 5 seconds (configurable)
- âœ… Slack API integration optional and secure
- âœ… Notification history available in sidebar
- âœ… All notifications logged to app database

---

## ğŸ“‹ Phase Breakdown

### Phase 1: Toast Notification System (1-2 days)

**Deliverables:**

- Notification component (Svelte + Tailwind)
- Notification store (Svelte store for state management)
- Auto-dismiss logic with configurable timing
- Animation/transitions (slide-in, slide-out)

**Tasks:**

| #   | Task                                          | Effort | Owner |
| --- | --------------------------------------------- | ------ | ----- |
| 1.1 | Design notification component                 | 30 min | Dev   |
| 1.2 | Create Svelte `Notification.svelte` component | 1 hr   | Dev   |
| 1.3 | Build notification store (add, remove, clear) | 45 min | Dev   |
| 1.4 | Add dismiss animations (fade/slide)           | 1 hr   | Dev   |
| 1.5 | Implement timeout auto-dismiss                | 30 min | Dev   |
| 1.6 | Create notification container layout          | 45 min | Dev   |
| 1.7 | Write unit tests (5 test cases)               | 1 hr   | Dev   |
| 1.8 | Documentation: Notification API               | 30 min | Dev   |

**Test Cases:**

1. Notification appears when triggered
2. Auto-dismisses after timeout
3. Manual dismiss works
4. Multiple notifications stack correctly
5. Clear all notifications

**Files to Create:**

- `src/lib/components/Notification.svelte`
- `src/lib/stores/notificationStore.ts`
- `src/lib/components/NotificationContainer.svelte`
- `src/lib/types/notification.ts`

---

### Phase 2: Notification Types & Styling (1 day)

**Deliverables:**

- Info, success, warning, error notification types
- Color-coded UI (green, blue, orange, red)
- Icon support for each type
- Consistent styling with app theme

**Tasks:**

| #   | Task                                   | Effort | Owner  |
| --- | -------------------------------------- | ------ | ------ |
| 2.1 | Define notification types (TypeScript) | 30 min | Dev    |
| 2.2 | Create info notification style         | 30 min | Design |
| 2.3 | Create success notification style      | 30 min | Design |
| 2.4 | Create warning notification style      | 30 min | Design |
| 2.5 | Create error notification style        | 30 min | Design |
| 2.6 | Add icons (emoji or SVG)               | 45 min | Dev    |
| 2.7 | Integration tests (4 type variants)    | 1 hr   | Dev    |
| 2.8 | Update component documentation         | 30 min | Dev    |

**Notification Types:**

```typescript
type NotificationType = "info" | "success" | "warning" | "error";

interface Notification {
  id: string;
  type: NotificationType;
  title: string;
  message: string;
  duration?: number; // ms (default: 5000)
  action?: {
    label: string;
    callback: () => void;
  };
}
```

**UI Styling Reference:**

| Type        | Color            | Icon | Use Case                 |
| ----------- | ---------------- | ---- | ------------------------ |
| **info**    | Blue (#3b82f6)   | â„¹ï¸   | General information      |
| **success** | Green (#10b981)  | âœ…   | Operation completed      |
| **warning** | Orange (#f59e0b) | âš ï¸   | Caution/attention needed |
| **error**   | Red (#ef4444)    | âŒ   | Error/failure            |

---

### Phase 3: Integration with App Events (1-2 days)

**Deliverables:**

- Wire notifications to all major app events
- File save/load notifications
- Sync notifications (Notion, GitHub)
- Wizard/Goblin server notifications

**Tasks:**

| #   | Task                               | Effort | Owner |
| --- | ---------------------------------- | ------ | ----- |
| 3.1 | Wire file save notifications       | 45 min | Dev   |
| 3.2 | Wire file load notifications       | 45 min | Dev   |
| 3.3 | Wire Notion sync start/complete    | 1 hr   | Dev   |
| 3.4 | Wire Goblin server notifications   | 1 hr   | Dev   |
| 3.5 | Wire Wizard server notifications   | 1 hr   | Dev   |
| 3.6 | Wire error/exception notifications | 1 hr   | Dev   |
| 3.7 | Create notification history view   | 1 hr   | Dev   |
| 3.8 | Integration tests (8 scenarios)    | 1.5 hr | Dev   |

**Event Mapping:**

```
File Operations:
  - "File saved" (success)
  - "File loaded" (info)
  - "Save failed" (error)

Sync Operations:
  - "Syncing with Notion..." (info)
  - "Sync complete" (success)
  - "Sync failed" (error)

Server Operations:
  - "Goblin server started" (success)
  - "Wizard server started" (success)
  - "Server connection lost" (warning)
```

---

### Phase 4: Slack Integration (2-3 days)

**Deliverables:**

- Slack API client (optional, requires token)
- Send app notifications to Slack channel
- Receive Slack messages in app notification center
- Slack token secure storage (macOS Keychain)

**Tasks:**

| #   | Task                                 | Effort | Owner      |
| --- | ------------------------------------ | ------ | ---------- |
| 4.1 | Design Slack integration flow        | 1 hr   | Dev        |
| 4.2 | Create Slack API client (Rust/Tauri) | 1.5 hr | Dev        |
| 4.3 | Implement token storage (Keychain)   | 1 hr   | Dev        |
| 4.4 | Create Slack settings UI             | 1 hr   | Design/Dev |
| 4.5 | Wire notifications to Slack          | 1.5 hr | Dev        |
| 4.6 | Implement Slack message receiver     | 1.5 hr | Dev        |
| 4.7 | Rate limiting and error handling     | 1 hr   | Dev        |
| 4.8 | Unit tests (10 test cases)           | 1.5 hr | Dev        |
| 4.9 | Slack API documentation              | 45 min | Dev        |

**API Flow:**

```
uMarkdown Event â†’ Check if Slack enabled â†’ Get token from Keychain
  â†’ Format message â†’ Send to Slack API â†’ Log result

Slack Event â†’ Slack webhook â†’ Parse event â†’ Create notification
  â†’ Store in app database
```

**Slack Settings UI:**

```
Settings > Integrations > Slack
  [ ] Enable Slack integration
  [Input] Slack bot token
  [Select] Channel (multiselect)
  [Toggle] Notify on file changes
  [Toggle] Notify on sync events
  [Toggle] Notify on errors
  [Button] Test Connection
  [Button] Disconnect
```

---

### Phase 5: Notification History (1 day)

**Deliverables:**

- Notification history sidebar/panel
- Filter by type (info, success, warning, error)
- Search notifications
- Clear history
- Export notifications (JSON/CSV)

**Tasks:**

| #   | Task                           | Effort | Owner  |
| --- | ------------------------------ | ------ | ------ |
| 5.1 | Design notification history UI | 45 min | Design |
| 5.2 | Create history component       | 1 hr   | Dev    |
| 5.3 | Implement filtering logic      | 1 hr   | Dev    |
| 5.4 | Implement search/fuzzy match   | 1 hr   | Dev    |
| 5.5 | Add database persistence       | 1 hr   | Dev    |
| 5.6 | Create export functionality    | 1 hr   | Dev    |
| 5.7 | Write tests (6 test cases)     | 1 hr   | Dev    |
| 5.8 | Documentation                  | 30 min | Dev    |

**Database Schema:**

```sql
CREATE TABLE notifications (
  id TEXT PRIMARY KEY,
  type TEXT CHECK(type IN ('info', 'success', 'warning', 'error')),
  title TEXT NOT NULL,
  message TEXT,
  timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
  read BOOLEAN DEFAULT FALSE,
  archived BOOLEAN DEFAULT FALSE,
  source TEXT  -- 'file_operation', 'sync', 'server', etc.
);

CREATE INDEX idx_notifications_type ON notifications(type);
CREATE INDEX idx_notifications_timestamp ON notifications(timestamp DESC);
```

---

## ğŸ“Š Project Timeline

```
Week 1 (Mon-Fri):
  - Mon-Tue:  Phase 1 (Toast notifications)
  - Wed:      Phase 2 (Notification types)
  - Thu:      Phase 3 (App integration)

Week 2 (Mon-Fri):
  - Mon-Tue:  Phase 4 (Slack integration)
  - Wed:      Phase 5 (History & export)
  - Thu-Fri:  Testing, documentation, polish

Target Completion: ~10-12 days (1.5 weeks)
```

---

## ğŸ§ª Testing Strategy

### Unit Tests

- Notification store (add, remove, clear)
- Toast component (display, dismiss, animations)
- Slack client (format, send, error handling)

### Integration Tests

- File save â†’ notification flow
- Sync â†’ notification flow
- Slack connection â†’ notification sync

### E2E Tests

- User triggers file save â†’ notification appears â†’ dismisses
- User enables Slack â†’ notification sent to Slack
- User views notification history â†’ filters and searches

**Test Coverage Goal:** 85%+ (focus on notification logic)

---

## ğŸ¨ UI/UX Specifications

### Toast Notification Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… File saved successfully               â”‚ X
â”‚    example.md (342 bytes)                â”‚
â”‚    3 seconds ago                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Position:** Top-right corner, 16px margin from edges  
**Animation:** Slide in from right, fade out on dismiss  
**Width:** 300-400px (responsive)  
**Z-index:** 9999 (always on top)

### Notification Type Colors

```
Success: #10b981 (Emerald)
  Background: #ecfdf5 (Light emerald)
  Border-left: 4px solid #10b981

Error: #ef4444 (Red)
  Background: #fef2f2 (Light red)
  Border-left: 4px solid #ef4444

Warning: #f59e0b (Amber)
  Background: #fffbeb (Light amber)
  Border-left: 4px solid #f59e0b

Info: #3b82f6 (Blue)
  Background: #eff6ff (Light blue)
  Border-left: 4px solid #3b82f6
```

### Notification History Panel

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ History          [ğŸ”] [âš™ï¸]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Filter: [All â–¼] [Search...]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… File saved                    â”‚ 2:30 PM
â”‚ ğŸ“‹ Sync started                  â”‚ 2:25 PM
â”‚ âŒ Sync failed                   â”‚ 2:20 PM
â”‚ â„¹ï¸ Wizard online                  â”‚ 2:15 PM
â”‚ ...                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Clear History] [Export]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Considerations

### Slack Token Storage

**Requirement:** Never store Slack tokens in plain text or config files

**Solution:** Use native macOS Keychain via Tauri

```rust
// In Tauri command handler
#[tauri::command]
fn save_slack_token(token: String) -> Result<(), String> {
    // Use tauri::api::keyring for secure storage
    keyring::Entry::new("uDOS-Slack", "bot_token")
        .set_password(&token)
        .map_err(|e| e.to_string())
}
```

### Notification Content

- âœ… Safe: "File saved: example.md"
- âŒ Unsafe: "File saved: /Users/fredbook/secret/api_keys.md"
- âœ… Safe: "Slack connected"
- âŒ Unsafe: "Slack connected with token: xoxb-..."

### Slack API Rate Limiting

- Implement exponential backoff for failed requests
- Queue notifications if rate limit hit
- Max 1 message per second per channel

---

## ğŸ“¦ Dependencies (New)

**Frontend (already installed):**

- Svelte (v3.x) â€” UI components
- Tailwind CSS (v3.x) â€” Styling

**Backend (Tauri/Rust):**

- `reqwest` â€” HTTP client for Slack API
- `keyring` â€” Secure credential storage
- `tokio` â€” Async runtime

**External APIs:**

- Slack API v1 (requires bot token)
- Slack App manifest for Slack workspace

---

## ğŸš€ Rollout Plan

### Alpha (Week 1)

- Toast notifications working locally
- Basic notification types functional
- Ready for internal testing

### Beta (Week 2)

- All app events integrated
- Slack integration optional
- Documentation complete
- Ready for community feedback

### Production (v1.0.5.0 Release)

- All features stable
- 85%+ test coverage
- Performance optimized
- Full documentation

---

## ğŸ”„ Dependencies & Blockers

| Dependency       | Status      | Notes                  |
| ---------------- | ----------- | ---------------------- |
| Tauri v1.5+      | âœ… Ready    | Keychain API available |
| Svelte stores    | âœ… Ready    | Already in project     |
| Slack API access | â³ Required | Need to register bot   |
| macOS Keychain   | âœ… Ready    | Native OS feature      |

---

## ğŸ“š References

- [Slack API Documentation](https://api.slack.com/)
- [Tauri Keyring](https://docs.rs/tauri/latest/tauri/)
- [Svelte Stores](https://svelte.dev/docs#run-time-store-contract)
- [Tailwind CSS](https://tailwindcss.com/)

---

## âœ… Sign-Off Checklist (Before Release)

- [ ] All 5 phases complete
- [ ] 85%+ test coverage
- [ ] No security vulnerabilities
- [ ] Performance acceptable (animations smooth)
- [ ] Documentation complete
- [ ] Beta user feedback addressed
- [ ] Slack app approved by workspace admin
- [ ] Release notes prepared
- [ ] Commit to git + tag v1.0.5.0

---

_Last Updated: 2026-01-17_  
_Status: Planning_  
_Owner: Engineering Team_
