{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "title": "NetHack Hierarchical Dungeon Mapping",
  "description": "Dungeon levels using 120×50 cell grid (6,000 cells per level) with room detail via cell nesting",
  "version": "2.0.0",
  "last_updated": "2026-01-04",
  "source": "https://github.com/NetHack/NetHack",
  "system": "hierarchical_cells",

  "dungeon_system": {
    "layer_range": "400-455",
    "grid_dimensions": {"columns": 120, "rows": 50},
    "cells_per_level": 6000,
    "coordinate_format": "VIRTUAL-NETH-L[LAYER]-[CELL1]-[CELL2]...",
    "example_base": "VIRTUAL-NETH-L401 (6,000 cells)",
    "example_room": "VIRTUAL-NETH-L401-BC45 (zoom into room BC45, 6,000 sub-cells)",
    "example_detail": "VIRTUAL-NETH-L401-BC45-AA10 (specific treasure location)"
  },

  "main_dungeon": {
    "name": "Dungeon of Doom",
    "layers": "401-450",
    "depth_levels": 50,
    "description": "Primary dungeon from surface entrance to Wizard of Yendor",
    "cells_per_level": 6000,
    
    "key_levels": [
      {
        "layer": 401,
        "depth": 1,
        "name": "Dungeon Level 1",
        "coordinate": "VIRTUAL-NETH-L401",
        "difficulty": 1,
        "features": ["entrance", "upstairs", "downstairs", "fountain"],
        "monsters": ["grid bug", "newt", "lichen", "goblin"],
        "description": "Entry level. Safe starting area with basic monsters.",
        "special_rooms": [
          {
            "type": "treasure_zoo",
            "cell": "BC45",
            "coordinate": "VIRTUAL-NETH-L401-BC45"
          }
        ],
        "avg_items": 8,
        "dungeon_size": "~80×40 cells (fits 120×50 grid perfectly)"
      },
      {
        "layer": 402,
        "depth": 2,
        "coordinate": "VIRTUAL-NETH-L402",
        "difficulty": 2,
        "features": ["shop", "altar"],
        "monsters": ["hobbit", "dwarf", "orc"],
        "special_rooms": [
          {
            "type": "shop",
            "cell": "AA20",
            "coordinate": "VIRTUAL-NETH-L402-AA20",
            "shopkeeper": "Izchak"
          },
          {
            "type": "temple",
            "cell": "CD35",
            "coordinate": "VIRTUAL-NETH-L402-CD35"
          }
        ],
        "avg_items": 10
      },
      {
        "layer": 405,
        "depth": 5,
        "name": "Oracle Level",
        "coordinate": "VIRTUAL-NETH-L405",
        "difficulty": 5,
        "features": ["oracle", "fountain"],
        "monsters": ["soldier", "watchman"],
        "special_rooms": [
          {
            "type": "oracle_chamber",
            "cell": "BC20",
            "coordinate": "VIRTUAL-NETH-L405-BC20",
            "npc": "Oracle"
          }
        ],
        "special": "Oracle provides guidance for 50-100 gold",
        "avg_items": 12
      },
      {
        "layer": 410,
        "depth": 10,
        "name": "Big Room",
        "coordinate": "VIRTUAL-NETH-L410",
        "difficulty": 10,
        "features": ["large_room"],
        "monsters": ["troll", "minotaur", "centaur"],
        "description": "Massive open chamber, high monster density (uses ~100×40 of the 120×50 grid)",
        "special_rooms": [
          {
            "type": "big_room",
            "cells": "AA00 to DA40",
            "description": "One huge room taking most of level"
          }
        ],
        "avg_items": 20
      },
      {
        "layer": 420,
        "depth": 20,
        "name": "Castle Entrance",
        "coordinate": "VIRTUAL-NETH-L420",
        "difficulty": 20,
        "features": ["drawbridge", "moat"],
        "monsters": ["soldier", "sergeant", "lieutenant"],
        "special_rooms": [
          {
            "type": "castle_entrance",
            "cell": "BC25",
            "coordinate": "VIRTUAL-NETH-L420-BC25"
          }
        ],
        "description": "Guarded entrance to Castle stronghold",
        "avg_items": 15
      },
      {
        "layer": 425,
        "depth": 25,
        "name": "Medusa's Island",
        "coordinate": "VIRTUAL-NETH-L425",
        "difficulty": 25,
        "features": ["island", "water", "statue_traps"],
        "monsters": ["Medusa"],
        "boss": {
          "name": "Medusa",
          "cell": "AA10",
          "coordinate": "VIRTUAL-NETH-L425-AA10",
          "hp": 100,
          "attacks": ["gaze_petrification", "bite", "weapon"],
          "strategy": "Use mirror or blindness to avoid gaze"
        },
        "treasure": ["wand_of_wishing_possible"],
        "avg_items": 25
      },
      {
        "layer": 430,
        "depth": 30,
        "name": "Castle Interior",
        "coordinate": "VIRTUAL-NETH-L430",
        "difficulty": 30,
        "features": ["throne", "wand_of_wishing"],
        "monsters": ["dragon", "giant", "vampire"],
        "special_rooms": [
          {
            "type": "throne_room",
            "cell": "BC30",
            "coordinate": "VIRTUAL-NETH-L430-BC30",
            "treasure": ["guaranteed_wand_of_wishing"]
          }
        ],
        "avg_items": 30
      },
      {
        "layer": 440,
        "depth": 40,
        "name": "Valley of the Dead",
        "coordinate": "VIRTUAL-NETH-L440",
        "difficulty": 40,
        "features": ["graveyard", "temple"],
        "monsters": ["lich", "wraith", "vampire_lord"],
        "description": "Massive graveyard, undead hordes (entire 120×50 grid filled)",
        "avg_items": 20
      },
      {
        "layer": 450,
        "depth": 50,
        "name": "Wizard's Tower",
        "coordinate": "VIRTUAL-NETH-L450",
        "difficulty": 50,
        "features": ["portal_to_elemental_planes"],
        "boss": {
          "name": "Wizard of Yendor",
          "cell": "BC25",
          "coordinate": "VIRTUAL-NETH-L450-BC25",
          "hp": 150,
          "attacks": ["magic_missile", "finger_of_death", "polymorph"],
          "respawns": true,
          "drops": ["Book of the Dead"]
        },
        "objective": "Obtain Book of the Dead",
        "avg_items": 10
      }
    ]
  },

  "gnomish_mines": {
    "name": "Gnomish Mines",
    "branch_from": "L402-L404",
    "layers": "451",
    "sub_levels": 12,
    "coordinate_format": "VIRTUAL-NETH-L451-[SUB_LEVEL]",
    "description": "Side branch with gnomes, dwarves, and mineral wealth",
    
    "levels": [
      {
        "coordinate": "VIRTUAL-NETH-L451-01",
        "depth": 1,
        "name": "Mine Entrance",
        "features": ["mine_shaft"],
        "monsters": ["gnome", "dwarf"],
        "avg_items": 12
      },
      {
        "coordinate": "VIRTUAL-NETH-L451-06",
        "depth": 6,
        "name": "Minetown",
        "features": ["shops", "temple", "watch"],
        "monsters": ["gnome_king", "dwarf_lord", "watchman"],
        "special_rooms": [
          {
            "type": "general_store",
            "cell": "AB20",
            "coordinate": "VIRTUAL-NETH-L451-06-AB20"
          },
          {
            "type": "armor_shop",
            "cell": "CD25",
            "coordinate": "VIRTUAL-NETH-L451-06-CD25"
          },
          {
            "type": "temple",
            "cell": "BC30",
            "coordinate": "VIRTUAL-NETH-L451-06-BC30"
          }
        ],
        "special": "Major trading hub with 2-3 shops",
        "avg_items": 25
      },
      {
        "coordinate": "VIRTUAL-NETH-L451-12",
        "depth": 12,
        "name": "Mine's End",
        "features": ["luckstone"],
        "treasure": [
          {
            "item": "guaranteed_luckstone",
            "cell": "AA10",
            "coordinate": "VIRTUAL-NETH-L451-12-AA10"
          }
        ],
        "avg_items": 15
      }
    ]
  },

  "sokoban": {
    "name": "Sokoban Puzzle Levels",
    "branch_from": "L406-L410",
    "layers": "452",
    "sub_levels": 4,
    "coordinate_format": "VIRTUAL-NETH-L452-[PUZZLE_NUM]",
    "description": "Boulder-pushing puzzle branch",
    
    "levels": [
      {
        "coordinate": "VIRTUAL-NETH-L452-01",
        "puzzle_difficulty": "easy",
        "reward_progress": "25%",
        "grid_size": "~20×20 cells (fits in 120×50 grid)"
      },
      {
        "coordinate": "VIRTUAL-NETH-L452-04",
        "puzzle_difficulty": "expert",
        "treasure": [
          {
            "items": ["amulet_of_reflection_OR_bag_of_holding"],
            "cell": "AA05",
            "coordinate": "VIRTUAL-NETH-L452-04-AA05"
          }
        ],
        "reward_progress": "100%"
      }
    ]
  },

  "elemental_planes": {
    "name": "Elemental Planes",
    "layers": "454",
    "coordinate_format": "VIRTUAL-NETH-L454-[PLANE]",
    "description": "Hostile elemental realms before ascension",
    
    "planes": [
      {
        "coordinate": "VIRTUAL-NETH-L454-01",
        "name": "Plane of Earth",
        "difficulty": 60,
        "features": ["solid_rock", "air_pockets"],
        "monsters": ["earth_elemental", "xorn"],
        "hazard": "Limited air, digging required",
        "portal_cell": "BC25",
        "portal_to": "VIRTUAL-NETH-L454-02"
      },
      {
        "coordinate": "VIRTUAL-NETH-L454-02",
        "name": "Plane of Air",
        "difficulty": 65,
        "features": ["clouds", "air_currents"],
        "monsters": ["air_elemental", "couatl"],
        "hazard": "Levitation required, no solid ground",
        "portal_cell": "BC25",
        "portal_to": "VIRTUAL-NETH-L454-03"
      },
      {
        "coordinate": "VIRTUAL-NETH-L454-03",
        "name": "Plane of Fire",
        "difficulty": 70,
        "features": ["lava", "fire"],
        "monsters": ["fire_elemental", "salamander"],
        "hazard": "Extreme heat, fire resistance required",
        "portal_cell": "BC25",
        "portal_to": "VIRTUAL-NETH-L454-04"
      },
      {
        "coordinate": "VIRTUAL-NETH-L454-04",
        "name": "Plane of Water",
        "difficulty": 75,
        "features": ["water", "bubbles"],
        "monsters": ["water_elemental", "kraken"],
        "hazard": "Underwater, drowning risk",
        "portal_cell": "BC25",
        "portal_to": "VIRTUAL-NETH-L455"
      }
    ]
  },

  "astral_plane": {
    "name": "Astral Plane",
    "coordinate": "VIRTUAL-NETH-L455",
    "difficulty": 80,
    "description": "Final level where you offer Amulet of Yendor to your god",
    
    "level": {
      "features": ["three_altars", "priests"],
      "altars": [
        {
          "alignment": "lawful",
          "cell": "AA20",
          "coordinate": "VIRTUAL-NETH-L455-AA20"
        },
        {
          "alignment": "neutral",
          "cell": "BC25",
          "coordinate": "VIRTUAL-NETH-L455-BC25"
        },
        {
          "alignment": "chaotic",
          "cell": "CD30",
          "coordinate": "VIRTUAL-NETH-L455-CD30"
        }
      ],
      "monsters": ["Angel", "Archon", "ki-rin"],
      "bosses": ["Famine", "Pestilence", "Death"],
      "objective": "Reach your aligned altar, offer Amulet of Yendor",
      "outcome": "Ascension to demigod status (win game)"
    }
  },

  "grid_benefits": {
    "dungeon_fit": "NetHack dungeons typically 80×40, fits perfectly in 120×50",
    "room_detail": "Zoom into any room (e.g., shop, temple) for 6,000 sub-cells",
    "sparse_storage": "Only store rooms that exist, ~10KB per level",
    "ascii_perfect": "120 columns = exact .udos.md map tile width"
  },

  "navigation_commands": {
    "descend": "DESCEND or > (go down stairs) → L401 to L402",
    "ascend": "ASCEND or < (go up stairs) → L402 to L401",
    "locate": "LOCATE VIRTUAL-NETH-L425-AA10 (Medusa's lair)",
    "zoom_in": "ZOOM IN BC45 (zoom into room BC45)",
    "map": "MAP VIRTUAL-NETH-L401 (show current level, 120×50 grid)"
  },

  "integration": {
    "state_file": "memory/adventures/nethack-playthrough.udos.md",
    "inventory_storage": "YAML frontmatter in .udos.md",
    "map_tiles": "ASCII dungeon maps in ```map blocks (120×50)",
    "save_format": ".udos.md with state persistence",
    "multiplayer": "MeshCore P2P sync for co-op dungeon crawling"
  },

  "metadata": {
    "created": "2026-01-04",
    "author": "uDOS Alpha v1.0.0.0",
    "system_version": "2.0.0 (hierarchical cells)",
    "replaces": "nethack_levels.json v1.0.0 (flat grid)",
    "references": [
      "https://nethackwiki.com/wiki/Dungeon",
      "MULTIVERSE-LAYERS.md"
    ]
  }
}
